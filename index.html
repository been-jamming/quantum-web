<!DOCTYPE html>
<html>
<head>
<title>Test</title>
<style>
canvas {
	width: 80%;
	height: 80%;
	padding: 0px;
	position: absolute;
	top: 0px;
	left: 0px;
}

body {
	margin: 0px;
}
</style>
<script src="math.js" type="text/javascript"></script>
</head>

<body>
<canvas class="wavefunction"></canvas>

<script>
	context = document.getElementsByClassName("wavefunction")[0].getContext("2d");
	context.canvas.width = window.innerWidth*0.8;
	context.canvas.height = window.innerHeight*0.8;
	context.fillStyle = "black";
	context.fillRect(0, 0, context.canvas.width, context.canvas.height);

	width = context.canvas.width;
	height = context.canvas.height;

	resolution = 200;

	function mod(a, b){
		return (a%b + b)%b;
	}

	function complex_to_color(val){
		var red;
		var green;
		var blue;
		var angle;

		angle = mod(Math.atan2(val.imag, val.real), 2*Math.PI);

		if(angle <= Math.PI/3 || angle >= 5*Math.PI/3){
			red = 1;
			if(angle <= Math.PI/3){
				green = angle*3/Math.PI;
				blue = 0;
			} else {
				green = 0;
				blue = 1 - (angle - 5*Math.PI/3)*3/Math.PI;
			}
		} else if(angle >= Math.PI/3 && angle <= Math.PI){
			green = 1;
			if(angle <= 2*Math.PI/3){
				red = (2*Math.PI/3 - angle)*3/Math.PI;
				blue = 0;
			} else {
				red = 0;
				blue = 1 - (Math.PI - angle)*3/Math.PI;
			}
		} else if(angle >= Math.PI && angle <= 5*Math.PI/3){
			blue = 1;
			if(angle <= 4*Math.PI/3){
				red = 0;
				green = (4*Math.PI/3 - angle)*3/Math.PI;
			} else {
				red = 1 - (5*Math.PI/3 - angle)*3/Math.PI;
				green = 0;
			}
		}

		return {red: red, green: green, blue: blue};
	}

	function draw_graph(vals){
		context.fillStyle = "black";
		context.fillRect(0, 0, width, height);
		for(var i = 0; i < resolution; i++){
			var color = complex_to_color(vals[i]);
			var len = Math.sqrt(vals[i].real*vals[i].real + vals[i].imag*vals[i].imag);
			context.fillStyle = "rgb("+255*color.red*len+","+255*color.green*len+","+255*color.blue*len+")";
			context.fillRect(width*i/resolution, height*(1 - len), width/resolution, height*len);
		}
	}

	vals = [];

	for(i = 0; i < resolution; i++){
		vals[i] = {real: Math.cos(i*2*Math.PI/resolution)*Math.abs(Math.sin(i*2*Math.PI/resolution + 2*Math.PI/3)), imag: Math.sin(i*2*Math.PI/resolution)*Math.abs(Math.sin(i*2*Math.PI/resolution + 2*Math.PI/3))};
	}

	draw_graph(vals);

	console.log(math.sqrt(-4).toString());
</script>
</body>
</html>
